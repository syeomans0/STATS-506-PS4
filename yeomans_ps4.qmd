---
title: "ps4_yeomans"
author: "Sydney Yeomans"
format:
  html:
    embed-resources: true
editor: visual
---

## Tidyverse packages

```{r}
library(tidyverse)
library(dplyr)

```

## Problem 1

Use the nzge data for this problem. Load the data set

```{r}
nzge <- load("~/R and Git/STATS-506-PS4/nzge.rda")
```

a. Generate a table (which can just be a nicely printed tibble) of vote count (regardless of party) per year/type. Make sure to sort it by vote count.

```{r}
vote_count <- nzge %>% 
            group_by(voting_type, election_year) %>% 
            summarize(count = sum(votes)) %>%
            arrange(desc(count)) %>%
            ungroup()
vote_count
```

b. Focus only on the 2014 election. Report the proportion of votes for each party in the Candidate election. Again, produce a nice table and sort it by percent of vote.

```{r}
year_2014 <- nzge %>% 
            filter(election_year == "2014", voting_type == "Candidate") %>%
            group_by(party) %>%
            summarise(votes = sum(votes)) %>%
            mutate(proportion_votes = (votes / sum(votes)) * 100) %>%
            arrange(desc(proportion_votes)) %>%
            ungroup()
year_2014

```

c. Produce a nice table indicating, for each year, which party won the Candidate vote and which party won the Party vote.

```{r}
who_won_what <- nzge %>%
                group_by(election_year, voting_type, party) %>%
                summarize(total_votes = sum(votes), .groups = "drop") %>%
                group_by(election_year, voting_type) %>%
                mutate(max_votes = max(total_votes)) %>%
                filter(total_votes == max_votes) %>%
                arrange(election_year, voting_type) %>%
                ungroup()
who_won_what

```



## Problem 2

Use the “ATP Matches” data from 2019

```{r}
atp <- read.csv("https://raw.githubusercontent.com/JeffSackmann/tennis_atp/refs/heads/master/atp_matches_2019.csv")

```

a. How many tournaments took place in 2019?

```{r}
tournaments <- atp %>%
              summarize(num_tourn = n_distinct(tourney_id))
              
tournaments

```
There were a toal of 128 tournaments in the year 2019. 

b. Did any player win more than one tournament? If so, how many players won more than one tournament, and how many tournaments did the most winning player(s) win?

```{r}
play_win <- atp %>%
            group_by(winner_name) %>%
            summarize(wins = n()) %>%
            filter(wins > 1) %>%
            arrange(desc(wins)) %>%
            ungroup()
play_win
```
We do see that some players won multiple tournaments. In total 171 players won more than one tournament and the player with the most amount of wins was Rafael Nadal. 


c. Is there any evidence that winners have more aces than losers? (If you address this with a hypothesis test, do not use base R functionality - continue to remain in the Tidyverse.)

```{r}

```

d. Identify the player(s) with the highest win-rate. (Note that this is NOT asking for the highest number of wins.) Restrict to players with at least 5 matches.

```{r}

```





## Problem 3

Use the NYTimes Covid data

```{r}
nyt <- read.csv("https://raw.githubusercontent.com/nytimes/covid-19-data/refs/heads/master/rolling-averages/us.csv")

```

a. How many major and minor spikes in cases were there?

```{r}

```

b. For the states with the highest and lowest overall rates per population, what differences do you see in their trajectories over time?

```{r}

```

c. Identify, to the best of your ability without a formal test, the first five states to experience Covid in a substantial way.

```{r}

```



